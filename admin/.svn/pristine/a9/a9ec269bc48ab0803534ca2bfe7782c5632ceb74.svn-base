<template>
    <div class='sideBarContainer'>
        <el-menu class="el-menu-vertical-demo" @select='select' @open="handleOpen" @close="handleClose" :collapse="sideBarIsCollapse" theme='dark' mode='vertical' :router='true'>
            <template v-for='levelOneItem in routerData'>
                <!-- 第一层 -->
                <el-submenu v-if='levelOneItem.hasSubMenu' :index='levelOneItem.path' :key='levelOneItem.name'>
                    <!-- 第二层 -->
                    <template slot='title'>
                        <i class="el-icon-message"></i>
                        <span slot="title">{{levelOneItem.alias}}</span>
                    </template>
                    <template v-for='levelTwoItem in levelOneItem.children'>
                        <el-submenu v-if='levelTwoItem.hasSubMenu' :index='levelOneItem.path + "/" + levelTwoItem.path' :key='levelTwoItem.name'>
                            <template slot='title'>
                                <i class="el-icon-message"></i>
                                <span slot="title">{{levelTwoItem.alias}}</span>
                            </template>
                            <template v-for='levelThreeItem in levelTwoItem.children'>
                                <!-- 第三层 -->
                                <el-menu-item :key='levelThreeItem.name' :index='levelOneItem.path + "/" + levelTwoItem.path + "/" + levelThreeItem.path' @click='menuIsClicked(levelThreeItem)'>
                                    <i class="el-icon-menu"></i>
                                    <span slot='title'>{{levelThreeItem.alias}}</span>
                                </el-menu-item>
                            </template>
                        </el-submenu>

                        <!-- 第二层 -->
                        <el-menu-item v-else :key='levelTwoItem.name' :index='levelOneItem.path + "/" + levelTwoItem.path' @click='menuIsClicked(levelTwoItem)'>
                            <i class="el-icon-menu"></i>
                            <span slot='title'>{{levelTwoItem.alias}}</span>
                        </el-menu-item>
                    </template>
                </el-submenu>
                <!-- 第一层 -->
                <el-menu-item v-else :key='levelOneItem.name' :index='levelOneItem.path' @click='menuIsClicked(levelOneItem)'>
                    <i class="el-icon-menu"></i>
                    <span slot='title'>{{levelOneItem.alias}}</span>
                </el-menu-item>
            </template>
        </el-menu>
    </div>
</template>

<script>
import { mapState, mapMutations } from 'vuex'
import { routerData } from '../../router'

export default {
    name: 'SideBar',
    data() {
        return {
            routerData
        };
    },
    computed: mapState([
        'sideBarIsCollapse'
    ]),
    methods: {
        ...mapMutations([
            'addNavBarTabTag'
        ]),
        handleOpen() {
            // console.log(key, keyPath);
        },
        handleClose() {
            // console.log(key, keyPath);
        },
        select() {
            // console.log('select-->', index, arr2)
        },
        menuIsClicked(item) {
            // 添加新的tab标签对象到数据源中
            this.addNavBarTabTag({
                alias: item.alias,
                routeName: item.name,
                clicked: true
            })
        }
    }
}
</script>

<style scoped>
.sideBarContainer {
    width: fit-content;
    background: green;
    position: fixed;
    top: 0;
    left: 0;
    height: 100%;
}

.el-menu-vertical-demo {
    height: 100%;
}

.el-menu-vertical-demo:not(.el-menu--collapse) {
    text-align: left;
    width: 200px;
}
</style>